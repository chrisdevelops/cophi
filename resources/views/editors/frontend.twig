{% extends 'layout.twig' %}

{% block containerClass %}"container-fluid"{% endblock %} 

{% block styles %}
    <style>
        textarea.form-control.textarea {
            height: 400px;
        }

        #output {
            width: 100%;
            height: 400px;
            border: none;
            background: white;
        }
    </style>
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-md-12">
            <div class="input-group">
                <textarea class="form-control textarea" placeholder="html" id="html"></textarea>
                <textarea class="form-control textarea" placeholder="css" id="css"></textarea>
                <textarea class="form-control textarea" placeholder="js" id="js"></textarea>
            </div>
        </div>
    </div>
    <div class="row my-2">
        <div class="col-md-12">
            <iframe id="output"></iframe>
        </div>
    </div>
{% endblock %}

{% block scripts %}
<script>
    let output = document.getElementById('output');
    output = output.contentWindow || output.contentDocument.document
        || output.contentDocument;
    document.addEventListener('input', () => {
        output.document.open();
        output.document.write(htmlEditor.getValue() +
            '<style>' + cssEditor.getValue() + '<\\/style>' +
            '<script>' + jsEditor.getValue() + '<\\/script>'
        );
        output.document.close();
    });

    let commonOpts = {
        lineNumbers: true,
        matchBrackets: true,
        theme: "monokai",
        indentUnit: 2,
        indentWithTabs: true,
    }

    var htmlEditor = CodeMirror.fromTextArea(
        document.getElementById("html"),
        Object.assign({mode: 'text/html', placeholder: 'html'}, commonOpts)
    );
    htmlEditor.setSize('33.33%', 500);

    var cssEditor = CodeMirror.fromTextArea(
        document.getElementById("css"),
        Object.assign({mode: 'text/css'}, commonOpts)
    );
    cssEditor.setSize('33.33%', 500);

    var jsEditor = CodeMirror.fromTextArea(
        document.getElementById("js"),
        Object.assign({mode: 'text/javascript'},commonOpts)
    );
    jsEditor.setSize('33.33%', 500);    
</script>
</script>
{% endblock %}